{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Documents/BilliardOS/app/src/lib/prisma.ts"],"sourcesContent":["import { PrismaClient } from \"@prisma/client\";\r\n\r\nconst prismaClientSingleton = () => {\r\n    return new PrismaClient();\r\n};\r\n\r\ntype PrismaClientSingleton = ReturnType<typeof prismaClientSingleton>;\r\n\r\nconst globalForPrisma = globalThis as unknown as {\r\n    prisma: PrismaClientSingleton | undefined;\r\n};\r\n\r\nexport const prisma = globalForPrisma.prisma ?? prismaClientSingleton();\r\n\r\nif (process.env.NODE_ENV !== \"production\") globalForPrisma.prisma = prisma;\r\n"],"names":[],"mappings":";;;;AAAA;;AAEA,MAAM,wBAAwB;IAC1B,OAAO,IAAI,6IAAY;AAC3B;AAIA,MAAM,kBAAkB;AAIjB,MAAM,SAAS,gBAAgB,MAAM,IAAI;AAEhD,wCAA2C,gBAAgB,MAAM,GAAG"}},
    {"offset": {"line": 68, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Documents/BilliardOS/app/src/app/api/tables/reset-status/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { prisma } from \"@/lib/prisma\";\r\n\r\nexport const dynamic = 'force-dynamic';\r\n\r\n// POST: Reset table statuses - set BOOKED tables to AVAILABLE if no active reservation\r\nexport async function POST() {\r\n    try {\r\n        // Find all tables with BOOKED status\r\n        const bookedTables = await prisma.table.findMany({\r\n            where: { status: 'BOOKED' }\r\n        });\r\n\r\n        const today = new Date();\r\n        today.setHours(0, 0, 0, 0);\r\n\r\n        let resetCount = 0;\r\n\r\n        for (const table of bookedTables) {\r\n            // Check if there's an active reservation for this table\r\n            const activeReservation = await prisma.reservation.findFirst({\r\n                where: {\r\n                    status: 'CONFIRMED',\r\n                    tableType: table.tableType,\r\n                    bookingDate: {\r\n                        gte: today\r\n                    }\r\n                }\r\n            });\r\n\r\n            // If no active reservation, reset to AVAILABLE\r\n            if (!activeReservation) {\r\n                await prisma.table.update({\r\n                    where: { id: table.id },\r\n                    data: { status: 'AVAILABLE' }\r\n                });\r\n                resetCount++;\r\n            }\r\n        }\r\n\r\n        return NextResponse.json({\r\n            success: true,\r\n            message: `Reset ${resetCount} table(s) from BOOKED to AVAILABLE`,\r\n            resetCount\r\n        });\r\n\r\n    } catch (error) {\r\n        console.error(\"Reset Table Status Error:\", error);\r\n        return NextResponse.json({ error: \"Internal Error\" }, { status: 500 });\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAEO,MAAM,UAAU;AAGhB,eAAe;IAClB,IAAI;QACA,qCAAqC;QACrC,MAAM,eAAe,MAAM,gIAAM,CAAC,KAAK,CAAC,QAAQ,CAAC;YAC7C,OAAO;gBAAE,QAAQ;YAAS;QAC9B;QAEA,MAAM,QAAQ,IAAI;QAClB,MAAM,QAAQ,CAAC,GAAG,GAAG,GAAG;QAExB,IAAI,aAAa;QAEjB,KAAK,MAAM,SAAS,aAAc;YAC9B,wDAAwD;YACxD,MAAM,oBAAoB,MAAM,gIAAM,CAAC,WAAW,CAAC,SAAS,CAAC;gBACzD,OAAO;oBACH,QAAQ;oBACR,WAAW,MAAM,SAAS;oBAC1B,aAAa;wBACT,KAAK;oBACT;gBACJ;YACJ;YAEA,+CAA+C;YAC/C,IAAI,CAAC,mBAAmB;gBACpB,MAAM,gIAAM,CAAC,KAAK,CAAC,MAAM,CAAC;oBACtB,OAAO;wBAAE,IAAI,MAAM,EAAE;oBAAC;oBACtB,MAAM;wBAAE,QAAQ;oBAAY;gBAChC;gBACA;YACJ;QACJ;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YACrB,SAAS;YACT,SAAS,CAAC,MAAM,EAAE,WAAW,kCAAkC,CAAC;YAChE;QACJ;IAEJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,6BAA6B;QAC3C,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAAiB,GAAG;YAAE,QAAQ;QAAI;IACxE;AACJ"}}]
}